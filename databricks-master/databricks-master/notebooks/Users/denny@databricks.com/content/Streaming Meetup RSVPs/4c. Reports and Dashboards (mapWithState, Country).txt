-- Databricks notebook source exported at Mon, 28 Mar 2016 15:44:08 UTC
-- MAGIC %md ## Reports and Dashboards using mapWithState (Country)
-- MAGIC This is the third notebook of the **Streaming Meetup RSVPs** set of notebooks.  The purpose of this notebook is to create a set of reports and dashboards using Spark SQL from the DataFrames generated by the Streaming Meetup RSVPs Streaming applications.
-- MAGIC 
-- MAGIC *Meetup Sources*
-- MAGIC * Based off of the [Meetup RSVP Ticker](http://meetup.github.io/stream/rsvpTicker/)
-- MAGIC * Reference: [Meetup Streaming API > RSVPs](http://www.meetup.com/meetup_api/docs/stream/2/rsvps/)%md ## Meetup Streaming Example

-- COMMAND ----------

select * from batch_meetup_stream_country order by count desc limit 20;

-- COMMAND ----------

select c.CountryCode3, f.count 
  from batch_meetup_stream_country f
    join countrycodes c
      on lcase(c.CountryCode2) = lcase(f.group_country)

-- COMMAND ----------

